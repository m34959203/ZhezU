(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,20351,e=>{"use strict";let t=(0,e.i(67784).default)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);e.s(["default",()=>t])},84694,50545,e=>{"use strict";var t=e.i(38122),a=e.i(36624),l=e.i(55995),s=e.i(25194),r=e.i(20351);e.s(["ImageIcon",()=>r.default],50545);var r=r,i=e.i(84580);function d({open:e,onClose:d,onInsert:n}){let[o,c]=(0,a.useState)(""),[x,m]=(0,a.useState)(null),[u,b]=(0,a.useState)(!1),[g,h]=(0,a.useState)(""),[p,f]=(0,a.useState)(!1),j=(0,a.useRef)(null),k=()=>{c(""),m(null),b(!1),h(""),f(!1),d()},v=(0,a.useCallback)(async e=>{if(!["image/jpeg","image/png","image/webp"].includes(e.type))return void h("Допустимые форматы: JPEG, PNG, WebP");if(e.size>5242880)return void h("Максимальный размер — 5 МБ");h(""),b(!0);let t=URL.createObjectURL(e);m(t);let a=new FormData;a.append("file",e);try{let e=await fetch("/api/admin/upload",{method:"POST",body:a});if(!e.ok){let t=await e.json().catch(()=>({}));throw Error(t.error||"Ошибка загрузки")}let{url:t}=await e.json();c(t),m(t)}catch(e){h(e instanceof Error?e.message:"Ошибка загрузки"),m(null)}finally{b(!1),URL.revokeObjectURL(t)}},[]),y=(0,a.useCallback)(e=>{e.preventDefault(),f(!1);let t=e.dataTransfer.files[0];t&&v(t)},[v]);return e?(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:k,children:(0,t.jsxs)("div",{className:"mx-4 w-full max-w-md rounded-xl bg-white p-6 shadow-2xl dark:bg-slate-800",onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:"Вставить изображение"}),(0,t.jsx)("button",{type:"button",onClick:k,className:"rounded-lg p-1 text-slate-400 hover:bg-slate-100 hover:text-slate-600 dark:hover:bg-slate-700 dark:hover:text-white",children:(0,t.jsx)(l.X,{size:20})})]}),(0,t.jsx)("div",{onDragOver:e=>{e.preventDefault(),f(!0)},onDragLeave:()=>f(!1),onDrop:y,onClick:()=>j.current?.click(),className:`mb-4 flex cursor-pointer flex-col items-center justify-center rounded-lg border-2 border-dashed p-8 transition-colors ${p?"border-blue-400 bg-blue-50 dark:border-blue-500 dark:bg-blue-500/10":"border-slate-300 bg-slate-50 hover:border-slate-400 dark:border-slate-600 dark:bg-slate-700/50 dark:hover:border-slate-500"}`,children:u?(0,t.jsx)(i.Loader2,{size:32,className:"animate-spin text-blue-500"}):x?(0,t.jsx)("img",{src:x,alt:"Preview",className:"max-h-40 max-w-full rounded-lg object-contain"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.Upload,{size:32,className:"mb-2 text-slate-400"}),(0,t.jsx)("p",{className:"text-sm font-medium text-slate-600 dark:text-slate-300",children:"Перетащите файл сюда"}),(0,t.jsx)("p",{className:"mt-1 text-xs text-slate-400",children:"или нажмите для выбора"}),(0,t.jsx)("p",{className:"mt-2 text-xs text-slate-400",children:"JPEG, PNG, WebP — до 5 МБ"})]})}),(0,t.jsx)("input",{ref:j,type:"file",accept:"image/jpeg,image/png,image/webp",className:"hidden",onChange:e=>{let t=e.target.files?.[0];t&&v(t)}}),(0,t.jsxs)("div",{className:"mb-4 flex items-center gap-3",children:[(0,t.jsx)("div",{className:"h-px flex-1 bg-slate-200 dark:bg-slate-700"}),(0,t.jsx)("span",{className:"text-xs text-slate-400",children:"или"}),(0,t.jsx)("div",{className:"h-px flex-1 bg-slate-200 dark:bg-slate-700"})]}),(0,t.jsx)("input",{type:"url",value:o,onChange:e=>{c(e.target.value),m(e.target.value||null),h("")},placeholder:"https://example.com/image.jpg",className:"mb-4 w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm text-slate-900 placeholder-slate-400 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 focus:outline-none dark:border-slate-600 dark:bg-slate-700 dark:text-white dark:placeholder-slate-500"}),g&&(0,t.jsx)("p",{className:"mb-3 text-sm text-red-500",children:g}),(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)("button",{type:"button",onClick:k,className:"rounded-lg px-4 py-2 text-sm font-medium text-slate-600 hover:bg-slate-100 dark:text-slate-300 dark:hover:bg-slate-700",children:"Отмена"}),(0,t.jsxs)("button",{type:"button",onClick:()=>{let e=o.trim();e&&(n(e),k())},disabled:!o.trim()||u,className:"rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700 disabled:opacity-50",children:[(0,t.jsx)(r.default,{size:14,className:"-mt-0.5 mr-1.5 inline-block"}),"Вставить"]})]})]})}):null}e.s(["default",()=>d],84694)}]);