(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8607],{32785:(e,t,s)=>{Promise.resolve().then(s.bind(s,34979))},34979:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>q});var a=s(90401),l=s(54917),r=s(50311),n=s(99514),i=s(43196),d=s(62017),o=s(71961),c=s(32454),x=s(98216),m=s(94923),b=s(4895),u=s(82263),h=s(34725),p=s(43962),g=s(6333),v=s(56924),j=s(42170),k=s(17547),f=s(27404),N=s(81484),y=s(92105),w=s(70361),C=s(75544),A=s(56427),z=s(38178),I=s(45447),S=s(50804),_=s(65158),T=s(53668),L=s(22206),M=s(30892),H=s(52249);let $=[{key:"students",label:"Количество студентов"},{key:"programs",label:"Программы обучения"},{key:"employment",label:"Трудоустройство"},{key:"years",label:"Годы опыта"},{key:"faculty",label:"Преподаватели"},{key:"masters",label:"Магистерские программы"}],E={news:"Новости",announcement:"Объявления",event:"События",achievement:"Достижения",university:"Университет",science:"Наука",students:"Студенты",sport:"Спорт",culture:"Культура"},O={hero:{label:"Hero-секция",icon:d.A,description:"Баннер с заголовком и статистикой"},programs:{label:"Программы",icon:o.A,description:"Карусель популярных программ"},news:{label:"Новости",icon:c.A,description:"Блок новостей и событий"},departments:{label:"Кафедры",icon:x.A,description:"Сетка кафедр"},cta:{label:"CTA",icon:m.A,description:"Призыв к действию"},text:{label:"Текст",icon:b.A,description:"Текстовый блок (HTML)"},image:{label:"Изображение",icon:u.A,description:"Изображение с подписью"},banner:{label:"Баннер",icon:h.A,description:"Баннер с фоном и кнопкой"},html:{label:"HTML",icon:p.A,description:"Произвольный HTML код"},divider:{label:"Разделитель",icon:g.A,description:"Линия или отступ между блоками"}},U=[{value:"full",label:"Полная ширина"},{value:"wide",label:"Широкий"},{value:"medium",label:"Средний"},{value:"narrow",label:"Узкий"}],D={kk:"",ru:"",en:""};function P(){return"b_"+Math.random().toString(36).slice(2,10)}async function R(e){let t=new FormData;t.append("file",e);try{let e=await fetch("/api/admin/upload",{method:"POST",body:t});if(!e.ok)return null;let{url:s}=await e.json();return s}catch{return null}}function F({block:e,index:t,total:s,expanded:l,onToggleExpand:r,onToggleVisibility:d,onRemove:o,onMoveUp:c,onMoveDown:x,onUpdateConfig:m,onUpdateSize:b}){let{attributes:u,listeners:h,setNodeRef:p,transform:g,transition:A,isDragging:z}=(0,n.gl)({id:e.id}),I={transform:i.Ks.Transform.toString(g),transition:A,zIndex:z?50:void 0},S=O[e.type],_=S.icon;return(0,a.jsxs)("div",{ref:p,style:I,className:`rounded-xl border bg-white transition-shadow dark:bg-slate-900 ${z?"border-blue-400 shadow-xl shadow-blue-500/20":e.visible?"border-slate-200 dark:border-slate-800":"border-dashed border-slate-300 opacity-60 dark:border-slate-700"}`,children:[(0,a.jsxs)("div",{className:"flex items-center gap-1.5 px-3 py-2.5 sm:gap-2 sm:px-4 sm:py-3",children:[(0,a.jsxs)("div",{className:"flex shrink-0 items-center gap-1",children:[(0,a.jsx)("button",{type:"button",className:"cursor-grab touch-none text-slate-400 hover:text-slate-600 dark:hover:text-slate-300",...u,...h,children:(0,a.jsx)(v.A,{size:18})}),(0,a.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,a.jsx)("button",{type:"button",disabled:0===t,onClick:c,className:"rounded p-0.5 text-slate-400 transition-colors hover:bg-slate-100 hover:text-slate-600 disabled:opacity-30 dark:hover:bg-slate-800",title:"Вверх",children:(0,a.jsx)(j.A,{size:12})}),(0,a.jsx)("button",{type:"button",disabled:t===s-1,onClick:x,className:"rounded p-0.5 text-slate-400 transition-colors hover:bg-slate-100 hover:text-slate-600 disabled:opacity-30 dark:hover:bg-slate-800",title:"Вниз",children:(0,a.jsx)(k.A,{size:12})})]})]}),(0,a.jsx)("div",{className:`flex h-8 w-8 shrink-0 items-center justify-center rounded-lg ${e.visible?"bg-blue-50 text-blue-600 dark:bg-blue-900/20 dark:text-blue-400":"bg-slate-100 text-slate-400 dark:bg-slate-800 dark:text-slate-500"}`,children:(0,a.jsx)(_,{size:16})}),(0,a.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-slate-900 dark:text-white",children:S.label}),(0,a.jsx)("span",{className:"ml-2 hidden text-xs text-slate-400 sm:inline",children:S.description})]}),(0,a.jsx)("select",{value:e.size,onChange:e=>b(e.target.value),className:"hidden rounded-md border border-slate-200 bg-white px-2 py-1 text-xs text-slate-600 sm:block dark:border-slate-700 dark:bg-slate-800 dark:text-slate-300",children:U.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,a.jsx)("button",{type:"button",onClick:d,className:`rounded-md p-1.5 transition-colors ${e.visible?"text-emerald-500 hover:bg-emerald-50 dark:hover:bg-emerald-900/20":"text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800"}`,title:e.visible?"Скрыть блок":"Показать блок",children:e.visible?(0,a.jsx)(f.A,{size:16}):(0,a.jsx)(N.A,{size:16})}),(0,a.jsx)("button",{type:"button",onClick:r,className:"rounded-md p-1.5 text-slate-400 transition-colors hover:bg-slate-100 hover:text-slate-600 dark:hover:bg-slate-800 dark:hover:text-slate-300",children:l?(0,a.jsx)(y.A,{size:16}):(0,a.jsx)(w.A,{size:16})}),(0,a.jsx)("button",{type:"button",onClick:o,className:"rounded-md p-1.5 text-red-400 transition-colors hover:bg-red-50 hover:text-red-600 dark:hover:bg-red-900/20",title:"Удалить блок",children:(0,a.jsx)(C.A,{size:16})})]}),l&&(0,a.jsxs)("div",{className:"border-t border-slate-100 px-4 py-4 dark:border-slate-800",children:[(0,a.jsxs)("div",{className:"mb-3 sm:hidden",children:[(0,a.jsx)("label",{className:"mb-1 block text-xs font-medium text-slate-600 dark:text-slate-400",children:"Размер"}),(0,a.jsx)("select",{value:e.size,onChange:e=>b(e.target.value),className:"w-full rounded-md border border-slate-200 bg-white px-2 py-1.5 text-sm dark:border-slate-700 dark:bg-slate-800 dark:text-slate-300",children:U.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,a.jsx)(G,{block:e,onUpdateConfig:m})]})]})}function G({block:e,onUpdateConfig:t}){let s=e.config,l="w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 focus:outline-none dark:border-slate-700 dark:bg-slate-800 dark:text-white";switch(e.type){case"hero":return(0,a.jsx)("p",{className:"text-xs text-slate-400",children:"Hero-секция использует настройки заголовка и статистики из вкладки \xabДанные\xbb."});case"programs":return(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"mb-1 block text-xs font-medium text-slate-600 dark:text-slate-400",children:"Макс. кол-во программ"}),(0,a.jsx)("input",{type:"number",min:1,max:12,value:s.maxItems||4,onChange:e=>t({...s,maxItems:parseInt(e.target.value)||4}),className:l+" max-w-[120px]"})]});case"news":return(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"mb-1 block text-xs font-medium text-slate-600 dark:text-slate-400",children:"Макс. кол-во новостей"}),(0,a.jsx)("input",{type:"number",min:1,max:12,value:s.maxItems||4,onChange:e=>t({...s,maxItems:parseInt(e.target.value)||4}),className:l+" max-w-[120px]"})]});case"departments":return(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"mb-1 block text-xs font-medium text-slate-600 dark:text-slate-400",children:"Кол-во колонок"}),(0,a.jsxs)("select",{value:s.columns||5,onChange:e=>t({...s,columns:parseInt(e.target.value)||5}),className:l+" max-w-[160px]",children:[(0,a.jsx)("option",{value:3,children:"3 колонки"}),(0,a.jsx)("option",{value:4,children:"4 колонки"}),(0,a.jsx)("option",{value:5,children:"5 колонок"})]})]});case"cta":return(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("p",{className:"text-xs text-slate-400",children:"Оставьте пустым, чтобы использовать текст из переводов."}),(0,a.jsx)(J,{label:"Заголовок",value:s.title||D,onChange:e=>t({...s,title:e})}),(0,a.jsx)(J,{label:"Описание",value:s.description||D,onChange:e=>t({...s,description:e})}),(0,a.jsx)(J,{label:"Текст кнопки",value:s.buttonText||D,onChange:e=>t({...s,buttonText:e})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"mb-1 block text-xs font-medium text-slate-600 dark:text-slate-400",children:"Ссылка кнопки"}),(0,a.jsx)("input",{type:"text",value:s.buttonLink||"",onChange:e=>t({...s,buttonLink:e.target.value}),placeholder:"/admission",className:l})]})]});case"text":return(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(B,{label:"Содержимое (HTML)",value:s.content,onChange:e=>t({...s,content:e})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"mb-1 block text-xs font-medium text-slate-600 dark:text-slate-400",children:"Выравнивание"}),(0,a.jsxs)("select",{value:s.align||"left",onChange:e=>t({...s,align:e.target.value}),className:l+" max-w-[160px]",children:[(0,a.jsx)("option",{value:"left",children:"По левому краю"}),(0,a.jsx)("option",{value:"center",children:"По центру"}),(0,a.jsx)("option",{value:"right",children:"По правому краю"})]})]})]});case"image":return(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(K,{label:"URL изображения",value:s.src,onChange:e=>t({...s,src:e})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"mb-1 block text-xs font-medium text-slate-600 dark:text-slate-400",children:"Alt-текст"}),(0,a.jsx)("input",{type:"text",value:s.alt||"",onChange:e=>t({...s,alt:e.target.value}),className:l})]}),(0,a.jsx)(J,{label:"Подпись",value:s.caption||D,onChange:e=>t({...s,caption:e})}),(0,a.jsxs)("label",{className:"flex items-center gap-2 text-sm text-slate-600 dark:text-slate-400",children:[(0,a.jsx)("input",{type:"checkbox",checked:s.rounded??!0,onChange:e=>t({...s,rounded:e.target.checked}),className:"rounded border-slate-300"}),"Скруглённые углы"]})]});case"banner":return(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(J,{label:"Заголовок",value:s.title,onChange:e=>t({...s,title:e})}),(0,a.jsx)(J,{label:"Описание",value:s.description||D,onChange:e=>t({...s,description:e})}),(0,a.jsx)(K,{label:"Фоновое изображение",value:s.backgroundImage||"",onChange:e=>t({...s,backgroundImage:e})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"mb-1 block text-xs font-medium text-slate-600 dark:text-slate-400",children:"Цвет фона"}),(0,a.jsx)("input",{type:"color",value:s.backgroundColor||"#1d56c9",onChange:e=>t({...s,backgroundColor:e.target.value}),className:"h-10 w-20 cursor-pointer rounded-lg border border-slate-200 dark:border-slate-700"})]}),(0,a.jsxs)("label",{className:"flex items-center gap-2 text-sm text-slate-600 dark:text-slate-400",children:[(0,a.jsx)("input",{type:"checkbox",checked:s.overlay??!0,onChange:e=>t({...s,overlay:e.target.checked}),className:"rounded border-slate-300"}),"Затемнение фона"]}),(0,a.jsx)(J,{label:"Текст кнопки",value:s.buttonText||D,onChange:e=>t({...s,buttonText:e})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"mb-1 block text-xs font-medium text-slate-600 dark:text-slate-400",children:"Ссылка кнопки"}),(0,a.jsx)("input",{type:"text",value:s.buttonLink||"",onChange:e=>t({...s,buttonLink:e.target.value}),placeholder:"/admission",className:l})]})]});case"html":return(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"mb-1 block text-xs font-medium text-slate-600 dark:text-slate-400",children:"HTML код"}),(0,a.jsx)("textarea",{value:s.code,onChange:e=>t({...s,code:e.target.value}),rows:6,className:l+" font-mono text-xs",placeholder:"<div>...</div>"})]});case"divider":return(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"mb-1 block text-xs font-medium text-slate-600 dark:text-slate-400",children:"Стиль"}),(0,a.jsxs)("select",{value:s.style||"line",onChange:e=>t({...s,style:e.target.value}),className:l+" max-w-[140px]",children:[(0,a.jsx)("option",{value:"line",children:"Линия"}),(0,a.jsx)("option",{value:"dots",children:"Точки"}),(0,a.jsx)("option",{value:"space",children:"Пустое место"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"mb-1 block text-xs font-medium text-slate-600 dark:text-slate-400",children:"Отступы"}),(0,a.jsxs)("select",{value:s.spacing||"md",onChange:e=>t({...s,spacing:e.target.value}),className:l+" max-w-[140px]",children:[(0,a.jsx)("option",{value:"sm",children:"Маленький"}),(0,a.jsx)("option",{value:"md",children:"Средний"}),(0,a.jsx)("option",{value:"lg",children:"Большой"})]})]})]});default:return null}}function J({label:e,value:t,onChange:s}){let[r,n]=(0,l.useState)("ru");return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-1 flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-xs font-medium text-slate-600 dark:text-slate-400",children:e}),(0,a.jsx)("div",{className:"flex gap-0.5",children:["ru","kk","en"].map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>n(e),className:`rounded px-1.5 py-0.5 text-[10px] font-bold uppercase ${r===e?"bg-blue-100 text-blue-700 dark:bg-blue-900/40 dark:text-blue-400":"text-slate-400 hover:text-slate-600"}`,children:e},e))})]}),(0,a.jsx)("input",{type:"text",value:t[r]||"",onChange:e=>s({...t,[r]:e.target.value}),className:"w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 focus:outline-none dark:border-slate-700 dark:bg-slate-800 dark:text-white"})]})}function B({label:e,value:t,onChange:s}){let[r,n]=(0,l.useState)("ru");return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-1 flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-xs font-medium text-slate-600 dark:text-slate-400",children:e}),(0,a.jsx)("div",{className:"flex gap-0.5",children:["ru","kk","en"].map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>n(e),className:`rounded px-1.5 py-0.5 text-[10px] font-bold uppercase ${r===e?"bg-blue-100 text-blue-700 dark:bg-blue-900/40 dark:text-blue-400":"text-slate-400 hover:text-slate-600"}`,children:e},e))})]}),(0,a.jsx)("textarea",{value:t[r]||"",onChange:e=>s({...t,[r]:e.target.value}),rows:4,className:"w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 focus:outline-none dark:border-slate-700 dark:bg-slate-800 dark:text-white"})]})}function K({label:e,value:t,onChange:s}){let[r,n]=(0,l.useState)(!1);return(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"mb-1 block text-xs font-medium text-slate-600 dark:text-slate-400",children:e}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[t&&(0,a.jsx)("div",{className:"h-10 w-10 shrink-0 overflow-hidden rounded-lg border border-slate-200 dark:border-slate-700",children:(0,a.jsx)("img",{src:t,alt:"",className:"h-full w-full object-cover"})}),(0,a.jsx)("input",{type:"url",value:t,onChange:e=>s(e.target.value),placeholder:"https://...",className:"w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 focus:outline-none dark:border-slate-700 dark:bg-slate-800 dark:text-white"}),(0,a.jsxs)("label",{className:"flex shrink-0 cursor-pointer items-center gap-1.5 rounded-lg border border-slate-200 bg-white px-3 py-2 text-xs font-medium text-slate-600 transition-colors hover:bg-slate-50 dark:border-slate-700 dark:bg-slate-800 dark:text-slate-300 dark:hover:bg-slate-700",children:[r?(0,a.jsx)(A.A,{size:14,className:"animate-spin"}):(0,a.jsx)(z.A,{size:14}),r?"...":"Загрузить",(0,a.jsx)("input",{type:"file",accept:"image/jpeg,image/png,image/webp",className:"hidden",onChange:async e=>{let t=e.target.files?.[0];if(!t)return;n(!0);let a=await R(t);a&&s(a),n(!1),e.target.value=""}})]})]})]})}function V({onAdd:e}){let[t,s]=(0,l.useState)(!1);return(0,a.jsxs)("div",{children:[(0,a.jsxs)("button",{type:"button",onClick:()=>s(!t),className:"flex w-full items-center justify-center gap-2 rounded-xl border-2 border-dashed border-slate-300 bg-slate-50 py-4 text-sm font-semibold text-slate-500 transition-colors hover:border-blue-400 hover:bg-blue-50 hover:text-blue-600 dark:border-slate-700 dark:bg-slate-900 dark:hover:border-blue-500 dark:hover:bg-blue-900/20 dark:hover:text-blue-400",children:[(0,a.jsx)(I.A,{size:18}),"Добавить блок"]}),t&&(0,a.jsxs)("div",{className:"mt-3 rounded-xl border border-slate-200 bg-white p-4 dark:border-slate-800 dark:bg-slate-900",children:[(0,a.jsx)("p",{className:"mb-3 text-xs font-semibold uppercase tracking-wider text-slate-400",children:"Встроенные секции"}),(0,a.jsx)("div",{className:"mb-4 grid grid-cols-2 gap-2 sm:grid-cols-3 md:grid-cols-5",children:["hero","programs","news","departments","cta"].map(t=>{let l=O[t],r=l.icon;return(0,a.jsxs)("button",{type:"button",onClick:()=>{e(t),s(!1)},className:"flex flex-col items-center gap-1.5 rounded-lg border border-slate-100 bg-slate-50 p-3 text-center transition-colors hover:border-blue-300 hover:bg-blue-50 dark:border-slate-800 dark:bg-slate-800/50 dark:hover:border-blue-600 dark:hover:bg-blue-900/20",children:[(0,a.jsx)(r,{size:20,className:"text-blue-500"}),(0,a.jsx)("span",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:l.label})]},t)})}),(0,a.jsx)("p",{className:"mb-3 text-xs font-semibold uppercase tracking-wider text-slate-400",children:"Пользовательские блоки"}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-3 md:grid-cols-5",children:["text","image","banner","html","divider"].map(t=>{let l=O[t],r=l.icon;return(0,a.jsxs)("button",{type:"button",onClick:()=>{e(t),s(!1)},className:"flex flex-col items-center gap-1.5 rounded-lg border border-slate-100 bg-slate-50 p-3 text-center transition-colors hover:border-emerald-300 hover:bg-emerald-50 dark:border-slate-800 dark:bg-slate-800/50 dark:hover:border-emerald-600 dark:hover:bg-emerald-900/20",children:[(0,a.jsx)(r,{size:20,className:"text-emerald-500"}),(0,a.jsx)("span",{className:"text-xs font-medium text-slate-700 dark:text-slate-300",children:l.label})]},t)})})]})]})}function q(){let[e,t]=(0,l.useState)(null),[s,i]=(0,l.useState)([]),[o,c]=(0,l.useState)(!0),[x,m]=(0,l.useState)(!1),[b,u]=(0,l.useState)(!1),[h,p]=(0,l.useState)(new Set),[g,v]=(0,l.useState)(null),[j,k]=(0,l.useState)("builder"),f=(0,r.FR)((0,r.MS)(r.AN,{activationConstraint:{distance:5}}),(0,r.MS)(r.uN,{coordinateGetter:n.JR}));(0,l.useEffect)(()=>{let e=new AbortController;return Promise.all([fetch("/api/admin/homepage",{signal:e.signal}).then(e=>e.ok?e.json():null),fetch("/api/public/university",{signal:e.signal}).then(e=>e.ok?e.json():null)]).then(([e,s])=>{e&&t(e),s?.programs&&i(s.programs)}).catch(()=>{}).finally(()=>c(!1)),()=>e.abort()},[]);let N=e?.blocks||[],y=(0,l.useCallback)(s=>{e&&t({...e,blocks:s})},[e]);function w(e,t){let s=e+t;if(s<0||s>=N.length)return;let a=[...N],l=a[e];a[e]=a[s],a[s]=l,y(a.map((e,t)=>({...e,order:t})))}async function O(){if(e){m(!0),u(!1);try{(await fetch("/api/admin/homepage",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok&&(u(!0),setTimeout(()=>u(!1),2e3))}finally{m(!1)}}}if(o||!e)return(0,a.jsx)("div",{className:"flex items-center justify-center py-32",children:(0,a.jsx)(A.A,{size:24,className:"animate-spin text-blue-500"})});let U="w-full rounded-lg border border-slate-200 bg-white px-4 py-2.5 text-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 focus:outline-none dark:border-slate-700 dark:bg-slate-800 dark:text-white";return(0,a.jsxs)("div",{className:"mx-auto max-w-4xl space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"flex items-center gap-2 text-xl font-bold text-slate-900 dark:text-white",children:[(0,a.jsx)(S.A,{size:22,className:"text-blue-500"}),"Конструктор страниц"]}),(0,a.jsx)("p",{className:"text-sm text-slate-500",children:"Управляйте блоками, порядком и содержимым главной страницы"})]}),(0,a.jsxs)("button",{type:"button",onClick:O,disabled:x,className:"flex items-center gap-2 rounded-lg bg-blue-600 px-5 py-2.5 text-sm font-semibold text-white transition-colors hover:bg-blue-700 disabled:opacity-50",children:[x?(0,a.jsx)(A.A,{size:14,className:"animate-spin"}):(0,a.jsx)(_.A,{size:14}),b?"Сохранено!":"Сохранить"]})]}),(0,a.jsxs)("div",{className:"flex gap-1 rounded-lg bg-slate-100 p-1 dark:bg-slate-800",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>k("builder"),className:`flex-1 rounded-md px-4 py-2 text-sm font-semibold transition-colors ${"builder"===j?"bg-white text-blue-600 shadow-sm dark:bg-slate-900 dark:text-blue-400":"text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-300"}`,children:[(0,a.jsx)(T.A,{size:14,className:"mr-1.5 inline"}),"Конструктор"]}),(0,a.jsxs)("button",{type:"button",onClick:()=>k("data"),className:`flex-1 rounded-md px-4 py-2 text-sm font-semibold transition-colors ${"data"===j?"bg-white text-blue-600 shadow-sm dark:bg-slate-900 dark:text-blue-400":"text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-300"}`,children:[(0,a.jsx)(L.A,{size:14,className:"mr-1.5 inline"}),"Данные"]})]}),"builder"===j&&(0,a.jsxs)("div",{className:"space-y-4",children:[0===N.length?(0,a.jsxs)("div",{className:"rounded-xl border border-dashed border-slate-300 bg-slate-50 py-16 text-center dark:border-slate-700 dark:bg-slate-900",children:[(0,a.jsx)(S.A,{size:40,className:"mx-auto mb-4 text-slate-300 dark:text-slate-600"}),(0,a.jsx)("h3",{className:"mb-2 text-lg font-bold text-slate-700 dark:text-slate-300",children:"Конструктор пуст"}),(0,a.jsx)("p",{className:"mb-6 text-sm text-slate-500",children:"Добавьте блоки или загрузите стандартную структуру"}),(0,a.jsxs)("button",{type:"button",onClick:function(){y([{id:P(),type:"hero",order:0,visible:!0,size:"full",config:{_type:"hero"}},{id:P(),type:"programs",order:1,visible:!0,size:"full",config:{_type:"programs",maxItems:4}},{id:P(),type:"news",order:2,visible:!0,size:"full",config:{_type:"news",maxItems:4}},{id:P(),type:"departments",order:3,visible:!0,size:"full",config:{_type:"departments",columns:5}},{id:P(),type:"cta",order:4,visible:!0,size:"full",config:{_type:"cta"}}])},className:"inline-flex items-center gap-2 rounded-lg bg-blue-600 px-5 py-2.5 text-sm font-semibold text-white transition-colors hover:bg-blue-700",children:[(0,a.jsx)(T.A,{size:16}),"Загрузить стандартные блоки"]})]}):(0,a.jsx)(r.Mp,{sensors:f,collisionDetection:r.fp,onDragEnd:function(e){let{active:t,over:s}=e;if(!s||t.id===s.id)return;let a=N.findIndex(e=>e.id===t.id),l=N.findIndex(e=>e.id===s.id);y((0,n.be)(N,a,l).map((e,t)=>({...e,order:t})))},children:(0,a.jsx)(n.gB,{items:N.map(e=>e.id),strategy:n._G,children:(0,a.jsx)("div",{className:"space-y-3",children:N.sort((e,t)=>e.order-t.order).map((e,t)=>(0,a.jsx)(F,{block:e,index:t,total:N.length,expanded:h.has(e.id),onToggleExpand:()=>{var t;return t=e.id,void p(e=>{let s=new Set(e);return s.has(t)?s.delete(t):s.add(t),s})},onToggleVisibility:()=>{var t;return t=e.id,void y(N.map(e=>e.id===t?{...e,visible:!e.visible}:e))},onRemove:()=>{var t;return t=e.id,void(y(N.filter(e=>e.id!==t).map((e,t)=>({...e,order:t}))),p(e=>{let s=new Set(e);return s.delete(t),s}))},onMoveUp:()=>w(t,-1),onMoveDown:()=>w(t,1),onUpdateConfig:t=>{var s;return s=e.id,void y(N.map(e=>e.id===s?{...e,config:t}:e))},onUpdateSize:t=>{var s;return s=e.id,void y(N.map(e=>e.id===s?{...e,size:t}:e))}},e.id))})})}),(0,a.jsx)(V,{onAdd:function(e){let t={id:P(),type:e,order:N.length,visible:!0,size:"full",config:function(e){switch(e){case"hero":return{_type:"hero"};case"programs":return{_type:"programs",maxItems:4};case"news":return{_type:"news",maxItems:4};case"departments":return{_type:"departments",columns:5};case"cta":return{_type:"cta"};case"text":return{_type:"text",content:{...D},align:"left"};case"image":return{_type:"image",src:"",alt:"",rounded:!0};case"banner":return{_type:"banner",title:{...D},overlay:!0};case"html":return{_type:"html",code:""};case"divider":return{_type:"divider",style:"line",spacing:"md"}}}(e)};y([...N,t]),p(e=>new Set(e).add(t.id))}})]}),"data"===j&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("section",{className:"rounded-xl border border-slate-200 bg-white p-6 dark:border-slate-800 dark:bg-slate-900",children:[(0,a.jsxs)("h3",{className:"mb-4 flex items-center gap-2 font-bold text-slate-900 dark:text-white",children:[(0,a.jsx)(d.A,{size:18,className:"text-blue-500"}),"Hero-секция"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"mb-1.5 block text-sm font-medium text-slate-700 dark:text-slate-300",children:"Заголовок (большой текст на главной)"}),(0,a.jsx)("input",{type:"text",value:e.heroTitle,onChange:s=>t({...e,heroTitle:s.target.value}),className:U})]})]}),(0,a.jsxs)("section",{className:"rounded-xl border border-slate-200 bg-white p-6 dark:border-slate-800 dark:bg-slate-900",children:[(0,a.jsxs)("h3",{className:"mb-2 flex items-center gap-2 font-bold text-slate-900 dark:text-white",children:[(0,a.jsx)(L.A,{size:18,className:"text-emerald-500"}),"Статистика на главной"]}),(0,a.jsx)("p",{className:"mb-4 text-xs text-slate-400",children:"Выберите какие показатели отображать на баннере. Значения берутся из раздела \xabУниверситет\xbb."}),(0,a.jsxs)("div",{className:"space-y-2",children:[e.stats.map((s,l)=>(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("select",{value:s,onChange:s=>{let a=[...e.stats];a[l]=s.target.value,t({...e,stats:a})},className:U,children:[(0,a.jsx)("option",{value:"",children:"— Выберите —"}),$.map(e=>(0,a.jsx)("option",{value:e.key,children:e.label},e.key))]}),(0,a.jsx)("button",{type:"button",onClick:()=>t({...e,stats:e.stats.filter((e,t)=>t!==l)}),className:"shrink-0 text-red-400 hover:text-red-600",children:(0,a.jsx)(C.A,{size:14})})]},l)),e.stats.length<$.length&&(0,a.jsxs)("button",{type:"button",onClick:()=>t({...e,stats:[...e.stats,""]}),className:"flex items-center gap-1 text-xs font-medium text-blue-500 hover:text-blue-600",children:[(0,a.jsx)(I.A,{size:12})," Добавить показатель"]})]})]}),(0,a.jsxs)("section",{className:"rounded-xl border border-slate-200 bg-white p-6 dark:border-slate-800 dark:bg-slate-900",children:[(0,a.jsxs)("h3",{className:"mb-2 flex items-center gap-2 font-bold text-slate-900 dark:text-white",children:[(0,a.jsx)(M.A,{size:18,className:"text-purple-500"}),"Изображения программ"]}),(0,a.jsx)("p",{className:"mb-4 text-xs text-slate-400",children:"Программы, которые будут показаны на главной странице с фотографией"}),(0,a.jsxs)("div",{className:"space-y-3",children:[Object.entries(e.programImages).map(([l,r])=>(0,a.jsxs)("div",{className:"flex flex-col gap-2 rounded-lg border border-slate-100 bg-slate-50 p-3 dark:border-slate-700 dark:bg-slate-800/50",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)("select",{value:l,onChange:s=>{let a={...e.programImages};delete a[l],a[s.target.value]=r,t({...e,programImages:a})},className:U+" max-w-[280px]",children:[(0,a.jsx)("option",{value:"",children:"— Выберите программу —"}),s.map(t=>(0,a.jsx)("option",{value:t.id,disabled:t.id!==l&&t.id in e.programImages,children:t.name.ru},t.id))]}),(0,a.jsx)("button",{type:"button",onClick:()=>{let{[l]:s,...a}=e.programImages;t({...e,programImages:a})},className:"shrink-0 text-red-400 hover:text-red-600",children:(0,a.jsx)(C.A,{size:14})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[r&&(0,a.jsx)("div",{className:"h-12 w-12 shrink-0 overflow-hidden rounded-lg border border-slate-200 dark:border-slate-700",children:(0,a.jsx)("img",{src:r,alt:"",className:"h-full w-full object-cover"})}),(0,a.jsx)("input",{type:"url",value:r,onChange:s=>t({...e,programImages:{...e.programImages,[l]:s.target.value}}),placeholder:"Ссылка на изображение",className:U}),(0,a.jsxs)("label",{className:"flex shrink-0 cursor-pointer items-center gap-1.5 rounded-lg border border-slate-200 bg-white px-3 py-2 text-xs font-medium text-slate-600 transition-colors hover:bg-slate-50 dark:border-slate-700 dark:bg-slate-800 dark:text-slate-300 dark:hover:bg-slate-700",children:[g===l?(0,a.jsx)(A.A,{size:14,className:"animate-spin"}):(0,a.jsx)(z.A,{size:14}),g===l?"Загрузка...":"Загрузить",(0,a.jsx)("input",{type:"file",accept:"image/jpeg,image/png,image/webp",className:"hidden",onChange:async e=>{let s=e.target.files?.[0];if(!s)return;v(l);let a=await R(s);a&&t(e=>e?{...e,programImages:{...e.programImages,[l]:a}}:e),v(null),e.target.value=""}})]})]})]},l)),(0,a.jsxs)("button",{type:"button",onClick:()=>t({...e,programImages:{...e.programImages,"":""}}),className:"flex items-center gap-1 text-xs font-medium text-blue-500 hover:text-blue-600",children:[(0,a.jsx)(I.A,{size:12})," Добавить программу"]})]})]}),(0,a.jsxs)("section",{className:"rounded-xl border border-slate-200 bg-white p-6 dark:border-slate-800 dark:bg-slate-900",children:[(0,a.jsxs)("h3",{className:"mb-2 flex items-center gap-2 font-bold text-slate-900 dark:text-white",children:[(0,a.jsx)(H.A,{size:18,className:"text-amber-500"}),"Метки категорий новостей"]}),(0,a.jsx)("p",{className:"mb-4 text-xs text-slate-400",children:"Текст, который отображается на карточках новостей для каждой категории"}),(0,a.jsx)("div",{className:"space-y-2",children:Object.entries(e.categoryLabels).map(([s,l])=>(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{className:"min-w-[120px] text-sm text-slate-500",children:E[s]??s}),(0,a.jsx)("input",{type:"text",value:l,onChange:a=>t({...e,categoryLabels:{...e.categoryLabels,[s]:a.target.value}}),className:U})]},s))})]})]})]})}}},e=>{e.O(0,[3058,9675,5334,7358],()=>e(e.s=32785)),_N_E=e.O()}]);