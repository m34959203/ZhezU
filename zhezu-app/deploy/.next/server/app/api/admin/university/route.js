(()=>{var a={};a.id=4566,a.ids=[4566],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4573:a=>{"use strict";a.exports=require("node:buffer")},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19771:a=>{"use strict";a.exports=require("process")},23289:()=>{},27910:a=>{"use strict";a.exports=require("stream")},28354:a=>{"use strict";a.exports=require("util")},29021:a=>{"use strict";a.exports=require("fs")},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:a=>{"use strict";a.exports=require("path")},34631:a=>{"use strict";a.exports=require("tls")},36441:()=>{},39013:(a,b,c)=>{"use strict";c.r(b),c.d(b,{news:()=>j,settings:()=>k});var d=c(61352),e=c(78869),f=c(45384),g=c(37977),h=c(89460),i=c(30029);let j=(0,d.Nn)("news",{id:(0,e.yf)("id",{length:36}).primaryKey(),slug:(0,e.yf)("slug",{length:255}).notNull().default(""),title:(0,f.Pq)("title").notNull().$type(),excerpt:(0,f.Pq)("excerpt").notNull().$type(),body:(0,f.Pq)("body").notNull().$type(),category:(0,e.yf)("category",{length:50}).notNull().default("news"),image:(0,g.Qq)("image"),published:(0,h.zM)("published").notNull().default(!1),pinned:(0,h.zM)("pinned").notNull().default(!1),author:(0,e.yf)("author",{length:255}).notNull().default(""),socialPublished:(0,f.Pq)("social_published").$type(),scheduledAt:(0,i.vE)("scheduled_at"),createdAt:(0,i.vE)("created_at").notNull().defaultNow(),updatedAt:(0,i.vE)("updated_at").notNull().defaultNow().onUpdateNow()}),k=(0,d.Nn)("settings",{key:(0,e.yf)("key",{length:100}).primaryKey(),value:(0,f.Pq)("value").notNull(),updatedAt:(0,i.vE)("updated_at").notNull().defaultNow().onUpdateNow()})},41204:a=>{"use strict";a.exports=require("string_decoder")},44870:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},45724:(a,b,c)=>{"use strict";c.d(b,{DZ:()=>t,TF:()=>q,UK:()=>m,getById:()=>n,kh:()=>w,mt:()=>s,n3:()=>v,vt:()=>o,yo:()=>p});var d=c(79748),e=c(33873),f=c.n(e),g=c(28012),h=c(95862),i=c(74560),j=c(39013),k=c(78679);let l="news.json";async function m(a){return(await (0,k.p)(),a===l)?(await i.db.select().from(j.news).orderBy((0,g.i)(j.news.createdAt))).map(y):await s(a,[])}async function n(a,b){if(a===l){let[a]=await i.db.select().from(j.news).where((0,h.eq)(j.news.id,b)).limit(1);return a?y(a):null}return(await m(a)).find(a=>a.id===b)??null}async function o(a,b){if(a===l)return await i.db.insert(j.news).values({id:b.id,slug:b.slug||"",title:b.title,excerpt:b.excerpt,body:b.body,category:b.category||"news",image:b.image||"",published:b.published??!1,pinned:b.pinned??!1,author:b.author||"",socialPublished:b.socialPublished,scheduledAt:b.scheduledAt?new Date(b.scheduledAt):null}),b;let c=await m(a);return c.unshift(b),await t(a,c),b}async function p(a,b,c){if(a===l){let a={};void 0!==c.slug&&(a.slug=c.slug),void 0!==c.title&&(a.title=c.title),void 0!==c.excerpt&&(a.excerpt=c.excerpt),void 0!==c.body&&(a.body=c.body),void 0!==c.category&&(a.category=c.category),void 0!==c.image&&(a.image=c.image),void 0!==c.published&&(a.published=c.published),void 0!==c.pinned&&(a.pinned=c.pinned),void 0!==c.author&&(a.author=c.author),void 0!==c.socialPublished&&(a.socialPublished=c.socialPublished),void 0!==c.scheduledAt&&(a.scheduledAt=c.scheduledAt?new Date(c.scheduledAt):null),await i.db.update(j.news).set(a).where((0,h.eq)(j.news.id,b));let[d]=await i.db.select().from(j.news).where((0,h.eq)(j.news.id,b)).limit(1);return d?y(d):null}let d=await m(a),e=d.findIndex(a=>a.id===b);return -1===e?null:(d[e]={...d[e],...c},await t(a,d),d[e])}async function q(a,b){if(a===l){let a=await i.db.delete(j.news).where((0,h.eq)(j.news.id,b));return(a[0]?.affectedRows??0)>0}let c=await m(a),d=c.filter(a=>a.id!==b);return d.length!==c.length&&(await t(a,d),!0)}function r(a){return a.replace(/\.json$/,"")}async function s(a,b){await (0,k.p)();let c=r(a),[d]=await i.db.select().from(j.settings).where((0,h.eq)(j.settings.key,c)).limit(1);if(!d)return b;let e=d.value;if("string"==typeof e)try{return JSON.parse(e)}catch{return b}return e}async function t(a,b){let c=r(a);await i.db.insert(j.settings).values({key:c,value:b}).onDuplicateKeyUpdate({set:{value:b}})}let u=f().join(process.cwd(),"src","i18n","messages");async function v(a){let b=f().join(u,`${a}.json`);return JSON.parse(await (0,d.readFile)(b,"utf-8"))}async function w(a,b){let c=f().join(u,`${a}.json`);await (0,d.writeFile)(c,JSON.stringify(b,null,2)+"\n","utf-8")}function x(a){if("string"==typeof a)try{return JSON.parse(a)}catch{}return a}function y(a){return{id:a.id,slug:a.slug,title:x(a.title),excerpt:x(a.excerpt),body:x(a.body),category:a.category,image:a.image||"",published:a.published,pinned:a.pinned,author:a.author,socialPublished:x(a.socialPublished)??void 0,scheduledAt:a.scheduledAt?.toISOString()??null,createdAt:a.createdAt.toISOString(),updatedAt:a.updatedAt.toISOString()}}},55511:a=>{"use strict";a.exports=require("crypto")},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},66136:a=>{"use strict";a.exports=require("timers")},72359:(a,b,c)=>{"use strict";c.d(b,{BE:()=>l,Ey:()=>i,Ht:()=>k,nr:()=>j,z4:()=>f});var d=c(55511),e=c(34003);let f="admin_token";function g(){let a=process.env.ADMIN_SECRET;if(!a||a.length<8)throw Error("ADMIN_SECRET env variable must be set (min 8 chars)");return a}function h(a){return(0,d.createHmac)("sha256",g()).update(a).digest("hex")}function i(){let a={role:"admin",exp:Date.now()+288e5},b=Buffer.from(JSON.stringify(a)).toString("base64url"),c=h(b);return`${b}.${c}`}function j(a){try{let[b,c]=a.split(".");if(!b||!c||h(b)!==c)return null;let d=JSON.parse(Buffer.from(b,"base64url").toString("utf-8"));if(d.exp<Date.now()||"admin"!==d.role)return null;return d}catch{return null}}async function k(){let a=await (0,e.UL)(),b=a.get(f)?.value;return b?j(b):null}function l(a){return a===g()}},74075:a=>{"use strict";a.exports=require("zlib")},74560:(a,b,c)=>{"use strict";c.d(b,{db:()=>h});var d=c(55256),e=c(23844),f=c(39013);let g=null,h=(0,d.fd)((g||(g=e.createPool({uri:function(){let a=process.env.DATABASE_URL;if(a)return a;let b=process.env.DB_HOST||"localhost",c=process.env.DB_PORT||"3306",d=process.env.DB_USER||"root",e=process.env.DB_PASSWORD||"",f=process.env.DB_NAME||"zhezu";return`mysql://${d}:${e}@${b}:${c}/${f}`}(),waitForConnections:!0,connectionLimit:5,maxIdle:2,idleTimeout:6e4})),g),{schema:f,mode:"default"})},78474:a=>{"use strict";a.exports=require("node:events")},78679:(a,b,c)=>{"use strict";c.d(b,{p:()=>k});var d=c(29021),e=c(33873),f=c.n(e),g=c(83664),h=c(74560),i=c(39013);let j=null;function k(){return j||(j=l().catch(a=>{console.error("[auto-seed] Error:",a),j=null})),j}async function l(){await h.db.execute((0,g.ll)`
    CREATE TABLE IF NOT EXISTS settings (
      \`key\` VARCHAR(100) PRIMARY KEY,
      value JSON NOT NULL,
      updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
    )
  `),await h.db.execute((0,g.ll)`
    CREATE TABLE IF NOT EXISTS news (
      id VARCHAR(36) PRIMARY KEY,
      slug VARCHAR(255) NOT NULL DEFAULT '',
      title JSON NOT NULL,
      excerpt JSON NOT NULL,
      body JSON NOT NULL,
      category VARCHAR(50) NOT NULL DEFAULT 'news',
      image TEXT,
      published BOOLEAN NOT NULL DEFAULT FALSE,
      pinned BOOLEAN NOT NULL DEFAULT FALSE,
      author VARCHAR(255) NOT NULL DEFAULT '',
      social_published JSON,
      scheduled_at TIMESTAMP NULL DEFAULT NULL,
      created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
      updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
    )
  `);try{await h.db.execute((0,g.ll)`
      ALTER TABLE news ADD COLUMN IF NOT EXISTS scheduled_at TIMESTAMP NULL DEFAULT NULL AFTER social_published
    `)}catch{}let[a]=await h.db.select({cnt:(0,g.ll)`count(*)`}).from(i.settings);if(a&&Number(a.cnt)>0)return;console.log("[auto-seed] Empty database detected — importing data/ files…");let b=function(){for(let a of[f().join(process.cwd(),"data"),f().join(process.cwd(),"..","data"),f().resolve(__dirname,"..","..","..","..","data")])if((0,d.existsSync)(a)&&(0,d.readdirSync)(a).length>0)return a;return null}();if(!b)return void console.warn("[auto-seed] data/ directory not found, skipping seed.");for(let a of["settings","contact","homepage","university","menu","tuition"]){let c=m(b,`${a}.json`);c&&(await h.db.insert(i.settings).values({key:a,value:c}).onDuplicateKeyUpdate({set:{value:c}}),console.log(`[auto-seed]   ✓ ${a}`))}let c=m(b,"news.json");if(c&&c.length>0){for(let a of c)await h.db.insert(i.news).values({id:a.id,slug:a.slug||"",title:a.title,excerpt:a.excerpt,body:a.body,category:a.category||"news",image:a.image||"",published:a.published??!1,pinned:a.pinned??!1,author:a.author||"",socialPublished:a.socialPublished}).onDuplicateKeyUpdate({set:{slug:a.slug||""}});console.log(`[auto-seed]   ✓ news (${c.length} articles)`)}console.log("[auto-seed] Seed complete.")}function m(a,b){let c=f().join(a,b);if(!(0,d.existsSync)(c))return null;try{return JSON.parse((0,d.readFileSync)(c,"utf-8"))}catch{return null}}},79428:a=>{"use strict";a.exports=require("buffer")},79551:a=>{"use strict";a.exports=require("url")},79748:a=>{"use strict";a.exports=require("fs/promises")},86140:a=>{function b(a){var b=Error("Cannot find module '"+a+"'");throw b.code="MODULE_NOT_FOUND",b}b.keys=()=>[],b.resolve=b,b.id=86140,a.exports=b},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},87657:(a,b,c)=>{"use strict";c.r(b),c.d(b,{handler:()=>H,patchFetch:()=>G,routeModule:()=>C,serverHooks:()=>F,workAsyncStorage:()=>D,workUnitAsyncStorage:()=>E});var d={};c.r(d),c.d(d,{GET:()=>A,PUT:()=>B});var e=c(755),f=c(24652),g=c(70563),h=c(9259),i=c(70797),j=c(24565),k=c(261),l=c(70207),m=c(3409),n=c(69771),o=c(91048),p=c(52902),q=c(54588),r=c(76214),s=c(34627),t=c(86439),u=c(82033),v=c(94050),w=c(72359),x=c(45724);let y="university.json",z={name:{kk:"",ru:"",en:""},shortName:"ZhezU",founded:1961,type:"private",website:"https://zhezu.edu.kz",rector:{name:{kk:"",ru:"",en:""},title:{kk:"",ru:"",en:""}},proRectors:[],stats:{students:0,programs:0,masterPrograms:0,employmentRate:0,yearsOfExperience:0,faculty:0,doctorsOfScience:0,candidatesOfScience:0,phd:0},departments:[],departmentHeads:{},programs:[],adminCenters:[],serviceUnits:[]};async function A(){if(!await (0,w.Ht)())return v.NextResponse.json({error:"Unauthorized"},{status:401});let a=await (0,x.mt)(y,z);return v.NextResponse.json(a)}async function B(a){if(!await (0,w.Ht)())return v.NextResponse.json({error:"Unauthorized"},{status:401});try{let b=await a.json(),c={...await (0,x.mt)(y,z),...b};return await (0,x.DZ)(y,c),v.NextResponse.json({ok:!0})}catch{return v.NextResponse.json({error:"Invalid data"},{status:400})}}let C=new e.AppRouteRouteModule({definition:{kind:f.RouteKind.APP_ROUTE,page:"/api/admin/university/route",pathname:"/api/admin/university",filename:"route",bundlePath:"app/api/admin/university/route"},distDir:".next",relativeProjectDir:"",resolvedPagePath:"/home/user/ZhezU/zhezu-app/src/app/api/admin/university/route.ts",nextConfigOutput:"standalone",userland:d}),{workAsyncStorage:D,workUnitAsyncStorage:E,serverHooks:F}=C;function G(){return(0,g.patchFetch)({workAsyncStorage:D,workUnitAsyncStorage:E})}async function H(a,b,c){C.isDev&&(0,h.addRequestMeta)(a,"devRequestTimingInternalsEnd",process.hrtime.bigint());let d="/api/admin/university/route";"/index"===d&&(d="/");let e=await C.prepare(a,b,{srcPage:d,multiZoneDraftMode:!1});if(!e)return b.statusCode=400,b.end("Bad Request"),null==c.waitUntil||c.waitUntil.call(c,Promise.resolve()),null;let{buildId:g,params:v,nextConfig:w,parsedUrl:x,isDraftMode:y,prerenderManifest:z,routerServerContext:A,isOnDemandRevalidate:B,revalidateOnlyGenerated:D,resolvedPathname:E,clientReferenceManifest:F,serverActionsManifest:G}=e,H=(0,k.normalizeAppPath)(d),I=!!(z.dynamicRoutes[H]||z.routes[E]),J=async()=>((null==A?void 0:A.render404)?await A.render404(a,b,x,!1):b.end("This page could not be found"),null);if(I&&!y){let a=!!z.routes[E],b=z.dynamicRoutes[H];if(b&&!1===b.fallback&&!a){if(w.experimental.adapterPath)return await J();throw new t.NoFallbackError}}let K=null;!I||C.isDev||y||(K="/index"===(K=E)?"/":K);let L=!0===C.isDev||!I,M=I&&!L;G&&F&&(0,j.setManifestsSingleton)({page:d,clientReferenceManifest:F,serverActionsManifest:G});let N=a.method||"GET",O=(0,i.getTracer)(),P=O.getActiveScopeSpan(),Q={params:v,prerenderManifest:z,renderOpts:{experimental:{authInterrupts:!!w.experimental.authInterrupts},cacheComponents:!!w.cacheComponents,supportsDynamicResponse:L,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:w.cacheLife,waitUntil:c.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:void 0,onInstrumentationRequestError:(b,c,d,e)=>C.onRequestError(a,b,d,e,A)},sharedContext:{buildId:g}},R=new l.NodeNextRequest(a),S=new l.NodeNextResponse(b),T=m.NextRequestAdapter.fromNodeNextRequest(R,(0,m.signalFromNodeResponse)(b));try{let e=async a=>C.handle(T,Q).finally(()=>{if(!a)return;a.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let c=O.getRootSpanAttributes();if(!c)return;if(c.get("next.span_type")!==n.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${c.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=c.get("next.route");if(e){let b=`${N} ${e}`;a.setAttributes({"next.route":e,"http.route":e,"next.span_name":b}),a.updateName(b)}else a.updateName(`${N} ${d}`)}),g=!!(0,h.getRequestMeta)(a,"minimalMode"),j=async h=>{var i,j;let k=async({previousCacheEntry:f})=>{try{if(!g&&B&&D&&!f)return b.statusCode=404,b.setHeader("x-nextjs-cache","REVALIDATED"),b.end("This page could not be found"),null;let d=await e(h);a.fetchMetrics=Q.renderOpts.fetchMetrics;let i=Q.renderOpts.pendingWaitUntil;i&&c.waitUntil&&(c.waitUntil(i),i=void 0);let j=Q.renderOpts.collectedTags;if(!I)return await (0,p.I)(R,S,d,Q.renderOpts.pendingWaitUntil),null;{let a=await d.blob(),b=(0,q.toNodeOutgoingHttpHeaders)(d.headers);j&&(b[s.NEXT_CACHE_TAGS_HEADER]=j),!b["content-type"]&&a.type&&(b["content-type"]=a.type);let c=void 0!==Q.renderOpts.collectedRevalidate&&!(Q.renderOpts.collectedRevalidate>=s.INFINITE_CACHE)&&Q.renderOpts.collectedRevalidate,e=void 0===Q.renderOpts.collectedExpire||Q.renderOpts.collectedExpire>=s.INFINITE_CACHE?void 0:Q.renderOpts.collectedExpire;return{value:{kind:u.CachedRouteKind.APP_ROUTE,status:d.status,body:Buffer.from(await a.arrayBuffer()),headers:b},cacheControl:{revalidate:c,expire:e}}}}catch(b){throw(null==f?void 0:f.isStale)&&await C.onRequestError(a,b,{routerKind:"App Router",routePath:d,routeType:"route",revalidateReason:(0,o.c)({isStaticGeneration:M,isOnDemandRevalidate:B})},!1,A),b}},l=await C.handleResponse({req:a,nextConfig:w,cacheKey:K,routeKind:f.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:z,isRoutePPREnabled:!1,isOnDemandRevalidate:B,revalidateOnlyGenerated:D,responseGenerator:k,waitUntil:c.waitUntil,isMinimalMode:g});if(!I)return null;if((null==l||null==(i=l.value)?void 0:i.kind)!==u.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==l||null==(j=l.value)?void 0:j.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});g||b.setHeader("x-nextjs-cache",B?"REVALIDATED":l.isMiss?"MISS":l.isStale?"STALE":"HIT"),y&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let m=(0,q.fromNodeOutgoingHttpHeaders)(l.value.headers);return g&&I||m.delete(s.NEXT_CACHE_TAGS_HEADER),!l.cacheControl||b.getHeader("Cache-Control")||m.get("Cache-Control")||m.set("Cache-Control",(0,r.getCacheControlHeader)(l.cacheControl)),await (0,p.I)(R,S,new Response(l.value.body,{headers:m,status:l.value.status||200})),null};P?await j(P):await O.withPropagatedContext(a.headers,()=>O.trace(n.BaseServerSpan.handleRequest,{spanName:`${N} ${d}`,kind:i.SpanKind.SERVER,attributes:{"http.method":N,"http.target":a.url}},j))}catch(b){if(b instanceof t.NoFallbackError||await C.onRequestError(a,b,{routerKind:"App Router",routePath:H,routeType:"route",revalidateReason:(0,o.c)({isStaticGeneration:M,isOnDemandRevalidate:B})},!1,A),I)throw b;return await (0,p.I)(R,S,new Response(null,{status:500})),null}}},91645:a=>{"use strict";a.exports=require("net")},94735:a=>{"use strict";a.exports=require("events")}};var b=require("../../../../webpack-runtime.js");b.C(a);var c=b.X(0,[1461,4003,5256,5767],()=>b(b.s=87657));module.exports=c})();